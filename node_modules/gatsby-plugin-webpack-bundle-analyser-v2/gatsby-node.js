"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

const {
  BundleAnalyzerPlugin
} = require('webpack-bundle-analyzer');

exports.onCreateWebpackConfig = ({
  stage,
  actions
}, _ref) => {
  let {
    disable = false,
    devMode = false
  } = _ref,
      options = (0, _objectWithoutPropertiesLoose2.default)(_ref, ["disable", "devMode"]);
  if (disable) return;

  if (stage === 'develop' && devMode || stage === 'build-javascript') {
    const defaultOptions = Object.assign({
      analyzerMode: 'server',
      analyzerPort: 3001
    }, options);
    actions.setWebpackConfig({
      plugins: [new BundleAnalyzerPlugin(defaultOptions)]
    });
  }
};